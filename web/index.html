<!DOCTYPE html>
<html>
    <link>
        <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"></link>
        <style type="text/css">
        .divTable
        {
            display:  table;
            width:auto;
            background-color:#eee;
            border:1px solid  #666666;
            border-spacing:5px;/*cellspacing:poor IE support for  this*/
        /* border-collapse:separate;*/
        }

        .divRow
        {
        display:table-row;
        width:auto;
        }

        .divCell
        {
            float:left;/*fix for  buggy browsers*/
            display:table-column;
            width:200px;
            background-color:#ccc;
        }
        </style>
        <script src="//code.jquery.com/jquery-1.12.4.js"></script>
        <script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <script>
            $(document).ready(function () {
                $("#recipe").autocomplete({
                    source: async function(request, response) {
                        let data = await fetch(`http://localhost:3000/search?query=${request.term}`)
                            .then(results => results.json())
                            .then(results => results.map(result => { 
                                return { label: `${result._id} (${result.count})` , value: result._id, id: result._id };
                            }));
                        response(data);
                    },
                    minLength: 2,
                    
                    select: function(event, ui) {
                        fetch(`http://localhost:3000/get/${ui.item.id}`)
                            .then(result => result.json())
                            .then(result => {
                                $("#row").empty();
                                result.forEach(item => {
                                    //$("#row").append(`<div class="divCell">${item.ground_truth.detections.source_file}</div>`);
                                    //$("#row").append(`<div class="divCell">${item.ground_truth.detections.label}</div>`);
                                    $("#row").append(`<div class="divCell">${item.ground_truth.detections.label}</div>`);
                                    $("#row").append(`<div class="divCell">${item.ground_truth.detections.Ship_size}</div>`);
                                    $("#row").append(`<div class="divCell">${item.ground_truth.detections.Ship_location}</div>`);
                                    $("#row").append(`<div class="divCell">${item.ground_truth.detections.Ship_area}</div>`);
                                    $("#row").append(`<div class="divCell">${item.ground_truth.detections.iscrowd}</div>`);
                                    //$("#row").append(`<li>${item.ground_truth.detections.label}</li>`);
                                });

                                
                            });
                    }
                });
            });
        </script>

    </head>
    <body>
        <div class="ui-widget">
            <label for="recipe">Search:</label><br />
            <input id="recipe">
        </div>
        <br/>
 
        <div class="divTable">
            <div class="headRow">
               <div  class="divCell">Ship Type (Label)</div>
               <div  class="divCell">Ship Size (Ship_size)</div>
               <div  class="divCell">Ship Location (Ship_location)  </div>
               <div  class="divCell">Ship Area (Ship_area)</div>
               <div  class="divCell">Any People? (iscrowd)</div>
            </div>
           <div id="row" class="divRow">
           </div>
     </div>
         

        <script>
            $(document).ready(function () {});
        </script>
    </body>
</html>